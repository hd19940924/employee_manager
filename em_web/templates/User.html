<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
        <link rel="stylesheet" href="{% static 'plugins/bootstrap-3.3.7-dist/css/bootstrap.css' %}">
        <link rel="stylesheet" href="{% static 'css/toastr.min.css' %}">

</head>
<script rel="script" src="{% static 'js/jquery-3.2.1.js' %}"></script>
<script rel="script" src="{% static 'plugins/bootstrap-3.3.7-dist/js/bootstrap.js'%}"></script>
<script rel="script" src='{% static "js/toastr.min.js" %}'></script>
<body>
<style>
#open-btn {
  margin-top: 50px;
  margin-left:1300px;
}
.panel panel-default{
    margin-top:50px;
}

</style>
<button id="open-btn">添加人员</button>

  <div id="form-container" style="display: none;">
    <form>{% csrf_token %}
      <div>
        <label for="name">姓名：</label>
        <input type="text" id="name" name="name">
      </div>
      <div>
        <label for="email">邮箱：</label>
        <input type="email" id="email" name="email">
      </div>
      <div>
        <label for="age">年龄：</label>
        <input type="number" id="age" name="age">
      </div>
      <button id="submit-btn" type="button">提交</button> <!-- 添加提交按钮 -->
    </form>
  </div>
<div class="panel panel-default" style="margin-top:30px">
            <div class="panel-heading">
                <span class="glyphicon glyphicon-th" aria-hidden="true"></span>
                用户列表
            </div>
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>姓名</th>
                    <th>邮箱</th>
                    <th>年龄</th>
                </tr>
                </thead>
                <tbody>
                {% for User in User_list %}
                <tr>
                    <td>{{User.id}}</td>
                    <td>{{User.name}}</td>
                    <td>{{User.email}}</td>
                    <td>{{User.age}}</td>
                    <td>
                        <a class="btn btn-primary btn-xs" href="/dep_update/?update_id={{ dep.id}}">编辑</a>
                       <!-- <a class="btn btn-danger btn-xs" href="/dep_del/?del_id={{dep.id}}">删除</a>-->
                       <!-- <a class="btn btn-danger btn-xs" href="#" onClick="showDeleteConfirmation({{dep.id}})">删除</a>-->
                       <!-- <a class="btn btn-danger btn-xs" href="#" onClick="showDeleteConfirmation({{dep.id}})">删除</a>-->
                        <a class="btn btn-danger btn-xs" href="#" onClick="showDeleteConfirmation({{dep.id}}, '{{dep.dep_name}}')">删除</a>
                    </td>
                </tr>
               {% endfor %}
                </tbody>
            </table>
        </div>
 <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
  <script src="https://cdn.bootcss.com/layer/3.1.1/layer.js"></script>
  <script >
 $('#open-btn').on('click', function () {
  var formIndex = layer.open({
    type: 1,
    title: '表单',
    skin: 'layui-layer-rim',
    area: ['420px', 'auto'],
    offset: 'auto', // 关闭自动定位
    content: $('#form-container')
  });

  // 新增提交按钮的点击事件监听
  $('#submit-btn').on('click', function () {
    // 获取表单数据
    var formData = $('#form-container form').serialize();
    console.log(formData);

    // 发送数据到服务器
    $.ajax({
      type: 'POST',//请求类型
      url: '/submit/',
      data: formData,
      success: function (data) {
        console.log(data);
        layer.close(formIndex);
        window.location.reload();//本地刷新

      },
      error: function (error) {
        console.error(error);
      }
    });
  });

  // 获取弹窗的高度和宽度
  var formHeight = $('#form-container').outerHeight();
  var formWidth = $('#form-container').outerWidth();

  // 设置提交按钮的位置
  $('.button-container').css({
    'position': 'absolute',
    'bottom': '20px',
    'right': '20px',
    'width': formWidth - 40 // 保证按钮和内容的宽度一致
  });
});
</script>
</body>
</html>